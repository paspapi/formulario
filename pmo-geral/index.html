<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMO 2026 - Plano de Manejo Orgânico | ANC</title>
    <meta name="description" content="Formulário digital para Plano de Manejo Orgânico da ANC - Associação de Agricultura Natural de Campinas">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <h1>PMO 2026</h1>
                    <p>Plano de Manejo Orgânico</p>
                </div>
                <div class="header-info">
                    <p><strong>ANC - Associação de Agricultura Natural de Campinas</strong></p>
                    <p>Sistema Participativo de Garantia da Qualidade Orgânica</p>
                </div>
            </div>
            
            <!-- Barra de Progresso -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div id="progress-text" class="progress-text">0% Completo</div>
            </div>
        </header>

        <nav class="form-nav">
            <ul class="nav-sections">
                <li><a href="#dados-empresa" class="nav-link" data-section="dados-empresa">Dados da Empresa</a></li>
                <li><a href="#fornecedores" class="nav-link" data-section="fornecedores">Fornecedores</a></li>
                <li><a href="#endereco" class="nav-link" data-section="endereco">Endereço</a></li>
                <li><a href="#historico" class="nav-link" data-section="historico">Histórico</a></li>
                <li><a href="#croqui" class="nav-link" data-section="croqui">Croqui</a></li>
                <li><a href="#produtos" class="nav-link" data-section="produtos">Produtos</a></li>
                <li><a href="#insumos" class="nav-link" data-section="insumos">Insumos</a></li>
                <li><a href="#comercializacao" class="nav-link" data-section="comercializacao">Comercialização</a></li>
            </ul>
        </nav>

        <form id="pmo-form" class="form-main" novalidate>
            <!-- Seção 1: Dados da Empresa/Unidade de Produção -->
            <section id="dados-empresa" class="form-section">
                <div class="section-header">
                    <h2>1. Dados da Empresa/Unidade de Produção</h2>
                    <div class="section-progress" data-section="dados-empresa"></div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="razao_social">Razão Social <span class="required">*</span></label>
                        <input type="text" id="razao_social" name="razao_social" required 
                               placeholder="Ex: João Silva ME, Silva & Associados Ltda">
                    </div>

                    <div class="form-group">
                        <label for="nome_unidade">Nome da Unidade de Produção <span class="required">*</span></label>
                        <input type="text" id="nome_unidade" name="nome_unidade" required 
                               placeholder="Ex: Sítio Boa Vista, Chácara São José">
                    </div>

                    <div class="form-group">
                        <label for="nome_fantasia">Nome Fantasia</label>
                        <input type="text" id="nome_fantasia" name="nome_fantasia" 
                               placeholder="Ex: Orgânicos da Serra">
                    </div>

                    <div class="form-group">
                        <label>Tipo de Documento <span class="required">*</span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="tipo_documento" value="cpf" onclick="toggleDocumento('cpf')"> CPF</label>
                            <label><input type="radio" name="tipo_documento" value="cnpj" onclick="toggleDocumento('cnpj')"> CNPJ</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label id="documento-label">CPF/CNPJ <span class="required">*</span></label>
                        <input type="text" id="documento" name="documento" required>
                    </div>

                    <div class="form-group">
                        <label for="inscricao_estadual">Inscrição Estadual</label>
                        <input type="text" id="inscricao_estadual" name="inscricao_estadual">
                    </div>

                    <div class="form-group">
                        <label for="inscricao_municipal">Inscrição Municipal</label>
                        <input type="text" id="inscricao_municipal" name="inscricao_municipal">
                    </div>

                    <div class="form-group">
                        <label for="area_total">Área Total da Propriedade (hectares) <span class="required">*</span></label>
                        <input type="number" id="area_total" name="area_total" step="0.01" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="area_organica">Área para Produção Orgânica (hectares) <span class="required">*</span></label>
                        <input type="number" id="area_organica" name="area_organica" step="0.01" min="0" required>
                    </div>
                </div>

                <!-- Situação Fundiária -->
                <div class="form-group">
                    <label>Situação da Propriedade <span class="required">*</span></label>
                    <div class="radio-group">
                        <label><input type="radio" name="situacao_propriedade" value="propria" onchange="toggleContrato(false)"> Própria</label>
                        <label><input type="radio" name="situacao_propriedade" value="arrendada" onchange="toggleContrato(true)"> Arrendada</label>
                        <label><input type="radio" name="situacao_propriedade" value="parceria" onchange="toggleContrato(true)"> Parceria</label>
                        <label><input type="radio" name="situacao_propriedade" value="comodato" onchange="toggleContrato(true)"> Comodato</label>
                    </div>
                </div>

                <div id="contrato-info" class="form-group" style="display: none;">
                    <label for="contrato_validade">Validade do Contrato <span class="required">*</span></label>
                    <input type="date" id="contrato_validade" name="contrato_validade">
                    
                    <label for="contrato_arquivo">Upload do Contrato</label>
                    <div class="file-upload">
                        <input type="file" id="contrato_arquivo" name="contrato_arquivo" accept=".pdf">
                        <label for="contrato_arquivo" class="file-label">
                            <span>📎 Selecionar Contrato</span>
                        </label>
                    </div>
                </div>

            </section>

            <!-- Seção 2: Dados dos Fornecedores -->
            <section id="fornecedores" class="form-section">
                <div class="section-header">
                    <h2>2. Dados dos Fornecedores/Responsáveis</h2>
                    <div class="section-progress" data-section="fornecedores"></div>
                </div>

                <div class="dynamic-table-wrapper">
                    <table id="tabela-fornecedores" class="dynamic-table">
                        <thead>
                            <tr>
                                <th>Nome Completo <span class="required">*</span></th>
                                <th>CPF <span class="required">*</span></th>
                                <th>Data de Nascimento <span class="required">*</span></th>
                                <th>Função/Cargo <span class="required">*</span></th>
                                <th>Telefones</th>
                                <th>Email</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="fornecedores-body">
                            <!-- Primeira linha padrão -->
                            <tr class="fornecedor-row">
                                <td>
                                    <input type="text" name="fornecedor_nome[]" required 
                                           placeholder="Nome completo">
                                </td>
                                <td>
                                    <input type="text" name="fornecedor_cpf[]" required 
                                           class="cpf-mask" placeholder="000.000.000-00">
                                </td>
                                <td>
                                    <input type="date" name="fornecedor_nascimento[]" required>
                                </td>
                                <td>
                                    <select name="fornecedor_funcao[]" required>
                                        <option value="">Selecione...</option>
                                        <option value="produtor_responsavel">Produtor Responsável</option>
                                        <option value="responsavel_tecnico">Responsável Técnico</option>
                                        <option value="sócio">Sócio</option>
                                        <option value="funcionario">Funcionário</option>
                                        <option value="outro">Outro</option>
                                    </select>
                                </td>
                                <td>
                                    <div class="multiple-contacts">
                                        <input type="tel" name="fornecedor_telefone[]" 
                                               class="phone-mask" placeholder="(00) 00000-0000">
                                        <button type="button" onclick="addContact(this, 'telefone')" class="btn-add-contact">+</button>
                                    </div>
                                </td>
                                <td>
                                    <div class="multiple-contacts">
                                        <input type="email" name="fornecedor_email[]" 
                                               placeholder="email@exemplo.com">
                                        <button type="button" onclick="addContact(this, 'email')" class="btn-add-contact">+</button>
                                    </div>
                                </td>
                                <td>
                                    <button type="button" onclick="removeFornecedor(this)" class="btn-remove" disabled>❌</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" onclick="addFornecedor()" class="btn-add">➕ Adicionar Fornecedor</button>
                </div>
            </section>

            <!-- Seção 3: Endereço -->
            <section id="endereco" class="form-section">
                <div class="section-header">
                    <h2>3. Endereço da Propriedade</h2>
                    <div class="section-progress" data-section="endereco"></div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="cep">CEP <span class="required">*</span></label>
                        <input type="text" id="cep" name="cep" required 
                               class="cep-mask" placeholder="00000-000"
                               onblur="buscarCEP()">
                    </div>

                    <div class="form-group span-2">
                        <label for="endereco">Endereço/Localização <span class="required">*</span></label>
                        <input type="text" id="endereco" name="endereco" required 
                               placeholder="Rua, Avenida, Estrada...">
                    </div>

                    <div class="form-group">
                        <label for="numero">Número</label>
                        <input type="text" id="numero" name="numero" placeholder="S/N">
                    </div>

                    <div class="form-group">
                        <label for="complemento">Complemento</label>
                        <input type="text" id="complemento" name="complemento" 
                               placeholder="Casa, Apto, Sítio...">
                    </div>

                    <div class="form-group">
                        <label for="bairro">Bairro/Zona Rural <span class="required">*</span></label>
                        <input type="text" id="bairro" name="bairro" required>
                    </div>

                    <div class="form-group">
                        <label for="cidade">Cidade <span class="required">*</span></label>
                        <input type="text" id="cidade" name="cidade" required>
                    </div>

                    <div class="form-group">
                        <label for="estado">Estado <span class="required">*</span></label>
                        <select id="estado" name="estado" required>
                            <option value="">Selecione...</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP" selected>SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>
                </div>

                <!-- Localização da Propriedade -->
                <div class="location-section">
                    <h3>📍 Localização Exata da Propriedade</h3>
                    
                    <div class="location-helper">
                        <div class="address-maps-link">
                            <button type="button" onclick="openMapsWithAddress()" class="btn-secondary">
                                🗺️ Abrir Google Maps com Este Endereço
                            </button>
                            <small class="help-text">
                                Clique para abrir o Google Maps já com o endereço preenchido acima. 
                                Você poderá refinar a localização exata da sua propriedade.
                            </small>
                        </div>
                        
                        <div class="coordinates-instructions">
                            <div class="info-box">
                                <p><strong>📋 Como obter as coordenadas:</strong></p>
                                <ol>
                                    <li>Clique no botão acima para abrir o Google Maps</li>
                                    <li>Encontre o local exato da sua propriedade</li>
                                    <li>Clique com botão direito no ponto exato</li>
                                    <li>Selecione <strong>"Copiar coordenadas"</strong> no menu</li>
                                    <li>Cole as coordenadas no campo abaixo</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    
                    <div class="coordinates-input">
                        <div class="form-group full-width">
                            <label for="coordenadas_google">Coordenadas do Google Maps <span class="required">*</span></label>
                            <input type="text" id="coordenadas_google" name="coordenadas_google" required
                                   placeholder="Cole aqui as coordenadas copiadas do Google Maps (ex: -22.906847, -47.062860)"
                                   onchange="parseCoordinates(this.value)">
                            <small class="help-text">
                                Clique com botão direito no Google Maps e selecione "Copiar coordenadas", 
                                depois cole aqui. As coordenadas serão separadas automaticamente.
                            </small>
                        </div>
                        
                        <div class="coordinates-display">
                            <div class="form-group">
                                <label for="latitude">Latitude</label>
                                <input type="text" id="latitude" name="latitude" readonly
                                       placeholder="Será preenchido automaticamente">
                            </div>
                            <div class="form-group">
                                <label for="longitude">Longitude</label>
                                <input type="text" id="longitude" name="longitude" readonly
                                       placeholder="Será preenchido automaticamente">
                            </div>
                        </div>
                        
                        <div id="coordinates-preview" class="coordinates-preview" style="display: none;">
                            <div class="success-message">
                                <h4>✅ Localização Confirmada</h4>
                                <div id="coordinates-details"></div>
                                <button type="button" onclick="verifyLocation()" class="btn-secondary">
                                    🔍 Verificar Localização no Google Maps
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção 4: Histórico da Área -->
            <section id="historico" class="form-section">
                <div class="section-header">
                    <h2>4. Histórico da Área</h2>
                    <div class="section-progress" data-section="historico"></div>
                </div>

                <div class="historico-wrapper">
                    <h3>Culturas dos Últimos 10 Anos</h3>
                    <p class="instruction">Complete as informações para cada ano, indicando as culturas plantadas e o tipo de manejo utilizado.</p>
                    
                    <div class="table-responsive">
                        <table id="historico-culturas" class="historico-table">
                            <thead>
                                <tr>
                                    <th>Ano</th>
                                    <th>Cultura/Animal</th>
                                    <th>Área (ha)</th>
                                    <th>Manejo Orgânico?</th>
                                    <th>Certificado?</th>
                                    <th>Último Insumo Não Permitido</th>
                                    <th>Data Aplicação</th>
                                </tr>
                            </thead>
                            <tbody id="historico-body">
                                <!-- Anos serão gerados via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Informações Complementares do Histórico -->
                    <div class="historico-complementar">
                        <h3>Informações Complementares do Histórico</h3>
                        
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label for="historico_atividade_anterior">Atividade Principal Antes da Agricultura Orgânica</label>
                                <textarea id="historico_atividade_anterior" name="historico_atividade_anterior" rows="3"
                                          placeholder="Ex: Agricultura convencional com milho e soja, pecuária extensiva, área de pasto..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="historico_inicio_organico">Ano de Início do Manejo Orgânico</label>
                                <input type="number" id="historico_inicio_organico" name="historico_inicio_organico" 
                                       min="1990" max="2026" placeholder="2020">
                            </div>
                            
                            <div class="form-group">
                                <label for="historico_certificacao_anterior">Certificação Orgânica Anterior?</label>
                                <select id="historico_certificacao_anterior" name="historico_certificacao_anterior" onchange="toggleCertificacaoAnterior(this)">
                                    <option value="">Selecione...</option>
                                    <option value="nao">Nunca foi certificado</option>
                                    <option value="sim_anc">Sim, pela ANC</option>
                                    <option value="sim_outra">Sim, por outra certificadora</option>
                                </select>
                            </div>
                            
                            <div id="certificacao-anterior-detalhes" class="form-group full-width" style="display: none;">
                                <label for="historico_certificadora_anterior">Nome da Certificadora Anterior</label>
                                <input type="text" id="historico_certificadora_anterior" name="historico_certificadora_anterior" 
                                       placeholder="Ex: IBD, ECOCERT, Certificadora XYZ">
                                
                                <label for="historico_periodo_certificacao" style="margin-top: 1rem;">Período da Certificação Anterior</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 0.5rem;">
                                    <input type="month" id="historico_periodo_inicio" name="historico_periodo_inicio" placeholder="Início">
                                    <input type="month" id="historico_periodo_fim" name="historico_periodo_fim" placeholder="Fim">
                                </div>
                                
                                <label for="historico_motivo_mudanca" style="margin-top: 1rem;">Motivo da Mudança de Certificadora (se aplicável)</label>
                                <textarea id="historico_motivo_mudanca" name="historico_motivo_mudanca" rows="2"
                                          placeholder="Ex: Custo, proximidade, filosofia de trabalho..."></textarea>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="historico_praticas_conservacao">Práticas de Conservação Implementadas</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="pratica_rotacao_culturas" value="rotacao"> Rotação de culturas</label>
                                    <label><input type="checkbox" name="pratica_adubacao_verde" value="adubacao_verde"> Adubação verde</label>
                                    <label><input type="checkbox" name="pratica_compostagem" value="compostagem"> Compostagem</label>
                                    <label><input type="checkbox" name="pratica_cobertura_solo" value="cobertura"> Cobertura do solo</label>
                                    <label><input type="checkbox" name="pratica_controle_biologico" value="biologico"> Controle biológico</label>
                                    <label><input type="checkbox" name="pratica_barreiras_vegetais" value="barreiras"> Barreiras vegetais</label>
                                    <label><input type="checkbox" name="pratica_conservacao_agua" value="agua"> Conservação de água</label>
                                    <label><input type="checkbox" name="pratica_diversificacao" value="diversificacao"> Diversificação de culturas</label>
                                </div>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="historico_desafios">Principais Desafios Enfrentados na Transição Orgânica</label>
                                <textarea id="historico_desafios" name="historico_desafios" rows="3"
                                          placeholder="Ex: Controle de pragas, fertilidade do solo, comercialização, custos..."></textarea>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="historico_melhorias">Melhorias Observadas com o Manejo Orgânico</label>
                                <textarea id="historico_melhorias" name="historico_melhorias" rows="3"
                                          placeholder="Ex: Melhoria da qualidade do solo, aumento da biodiversidade, redução de custos com insumos..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção 5: Croqui da Propriedade -->
            <section id="croqui" class="form-section">
                <div class="section-header">
                    <h2>5. Croqui da Propriedade</h2>
                    <div class="section-progress" data-section="croqui"></div>
                </div>

                <div class="croqui-info">
                    <div class="info-box">
                        <p><strong>ℹ️ Instruções:</strong> O croqui pode ser desenhado à mão, criado no computador, ou usar imagem do Google Maps/Earth</p>
                    </div>
                    
                    <div class="alert-box">
                        <p><strong>⚠️ OBRIGATÓRIO incluir no croqui:</strong></p>
                        <div class="requirements-grid">
                            <label><input type="checkbox" id="req-entrada"> Entrada da propriedade</label>
                            <label><input type="checkbox" id="req-casa"> Casa/Residência (se houver)</label>
                            <label><input type="checkbox" id="req-armazens"> Armazéns e galpões</label>
                            <label><input type="checkbox" id="req-insumos"> Local de guarda de insumos</label>
                            <label><input type="checkbox" id="req-rios"> Rios e cursos d'água</label>
                            <label><input type="checkbox" id="req-plantio"> Áreas de plantio (talhões, pomares, canteiros)</label>
                            <label><input type="checkbox" id="req-barreiras"> Barreiras vegetais</label>
                            <label><input type="checkbox" id="req-perenes"> Culturas perenes</label>
                            <label><input type="checkbox" id="req-processamento"> Locais de processamento</label>
                            <label><input type="checkbox" id="req-composteira"> Composteira</label>
                            <label><input type="checkbox" id="req-estradas"> Estradas</label>
                            <label><input type="checkbox" id="req-mata"> Áreas de mata</label>
                            <label><input type="checkbox" id="req-animais"> Instalações animais (se houver)</label>
                            <label><input type="checkbox" id="req-vizinhos"> Vizinhos confrontantes e suas atividades</label>
                        </div>
                    </div>
                </div>

                <div class="croqui-upload-area">
                    <div class="upload-options">
                        <button type="button" class="upload-btn" onclick="selectUploadType('file')">
                            📎 Upload de Arquivo
                        </button>
                        <button type="button" class="upload-btn" onclick="selectUploadType('draw')">
                            ✏️ Desenhar Online
                        </button>
                    </div>

                    <!-- Upload de Arquivo -->
                    <div id="file-upload-area" class="upload-type">
                        <div class="file-drop-zone" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)">
                            <input type="file" id="croqui-file" name="croqui_file" accept="image/*,.pdf" onchange="previewCroqui(this)">
                            <label for="croqui-file" class="file-drop-label">
                                <div class="drop-icon">📁</div>
                                <p>Clique ou arraste o arquivo aqui</p>
                                <small>Formatos aceitos: JPG, PNG, PDF (máx. 10MB)</small>
                            </label>
                        </div>
                        <div id="croqui-preview" class="file-preview"></div>
                    </div>

                    <!-- Canvas para Desenho -->
                    <div id="draw-area" class="upload-type" style="display:none;">
                        <div class="drawing-container">
                            <canvas id="drawing-canvas" width="800" height="600"></canvas>
                            <div class="drawing-tools">
                                <button type="button" class="tool-btn active" data-tool="pen" onclick="setTool('pen')">✏️ Caneta</button>
                                <button type="button" class="tool-btn" data-tool="eraser" onclick="setTool('eraser')">🧹 Borracha</button>
                                <button type="button" class="tool-btn" data-tool="text" onclick="setTool('text')">📝 Texto</button>
                                <div class="color-picker">
                                    <input type="color" id="pen-color" value="#000000" onchange="setPenColor(this.value)">
                                    <label for="pen-color">Cor</label>
                                </div>
                                <button type="button" onclick="clearCanvas()" class="btn-secondary">🗑️ Limpar</button>
                                <button type="button" onclick="saveDrawing()" class="btn-primary">💾 Salvar Desenho</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção 6: Lista de Produtos -->
            <section id="produtos" class="form-section">
                <div class="section-header">
                    <h2>6. Lista de Produtos para Certificação</h2>
                    <div class="section-progress" data-section="produtos"></div>
                </div>

                <div class="section-warning">
                    <p><strong>⚠️ ATENÇÃO:</strong> Esta lista constará no certificado. Apenas produtos aqui listados poderão ser comercializados em 2026</p>
                </div>

                <div class="products-table-wrapper">
                    <div class="table-actions top">
                        <button type="button" onclick="addProductRow()" class="btn-primary">➕ Adicionar Produto</button>
                        <button type="button" onclick="importProductList()" class="btn-secondary">📥 Importar Lista</button>
                        <button type="button" onclick="sortProducts()" class="btn-secondary">🔤 Ordenar Alfabeticamente</button>
                    </div>
                    
                    <div class="table-responsive">
                        <table id="tabela-produtos" class="products-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Produto/Variedade <span class="required">*</span></th>
                                    <th>Talhão/Área <span class="required">*</span></th>
                                    <th>Estimativa Produção <span class="required">*</span></th>
                                    <th>Período</th>
                                    <th>Peso (kg/und)</th>
                                    <th>Origem Muda</th>
                                    <th>Origem Semente</th>
                                    <th>Tipo</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="produtos-body">
                                <!-- Primeira linha padrão -->
                                <tr class="product-row">
                                    <td class="row-number">1</td>
                                    <td>
                                        <input type="text" name="produto_nome[]" required 
                                               placeholder="Ex: Alface Crespa" 
                                               list="produtos-sugestoes">
                                    </td>
                                    <td>
                                        <input type="text" name="produto_talhao[]" required 
                                               placeholder="Ex: Talhão 2 e 4">
                                    </td>
                                    <td>
                                        <div class="compound-field">
                                            <input type="number" name="produto_qtd[]" required min="0" step="0.01" placeholder="100">
                                            <select name="produto_unidade[]">
                                                <option>unidade</option>
                                                <option>maço</option>
                                                <option>kg</option>
                                                <option>bandeja</option>
                                                <option>dúzia</option>
                                                <option>caixa</option>
                                                <option>saca</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <select name="produto_periodo[]">
                                            <option>semanal</option>
                                            <option>quinzenal</option>
                                            <option>mensal</option>
                                            <option>bimestral</option>
                                            <option>semestral</option>
                                            <option>anual</option>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="number" name="produto_peso[]" step="0.001" min="0" placeholder="0.200">
                                    </td>
                                    <td>
                                        <select name="produto_origem_muda[]" onchange="checkCustom(this)">
                                            <option>N/A</option>
                                            <option>Própria</option>
                                            <option>Viveirista local</option>
                                            <option>Doada</option>
                                            <option value="custom">Outro...</option>
                                        </select>
                                        <input type="text" name="produto_origem_muda_custom[]" 
                                               style="display:none" 
                                               placeholder="Especifique">
                                    </td>
                                    <td>
                                        <input type="text" name="produto_origem_semente[]" 
                                               placeholder="Ex: Isla, Feltrin, Própria">
                                    </td>
                                    <td>
                                        <div class="checkbox-group">
                                            <label><input type="checkbox" name="produto_tipo_conv_trat[]"> Conv. c/ Trat.</label>
                                            <label><input type="checkbox" name="produto_tipo_conv_sem[]"> Conv. s/ Trat.</label>
                                            <label><input type="checkbox" name="produto_tipo_org[]"> Orgânica</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="action-buttons">
                                            <button type="button" onclick="duplicateRow(this)" title="Duplicar" class="btn-icon">📋</button>
                                            <button type="button" onclick="removeProductRow(this)" title="Remover" class="btn-icon">❌</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- DataList para sugestões de produtos -->
                <datalist id="produtos-sugestoes">
                    <!-- Será populado via JavaScript -->
                </datalist>
            </section>

            <!-- Seção 7: Insumos -->
            <section id="insumos" class="form-section">
                <div class="section-header">
                    <h2>7. Insumos e Produtos Comerciais</h2>
                    <div class="section-progress" data-section="insumos"></div>
                </div>

                <div class="insumos-tabs">
                    <button type="button" class="tab-btn active" onclick="showTab('fertilizantes')">Fertilizantes</button>
                    <button type="button" class="tab-btn" onclick="showTab('fitossanitarios')">Fitossanitários</button>
                    <button type="button" class="tab-btn" onclick="showTab('sementes')">Sementes/Mudas</button>
                    <button type="button" class="tab-btn" onclick="showTab('substratos')">Substratos</button>
                </div>

                <div id="fertilizantes" class="tab-content active">
                    <h3>Fertilizantes e Adubos</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Nome Comercial</th>
                                    <th>Ingrediente Ativo</th>
                                    <th>Fabricante</th>
                                    <th>Fornecedor</th>
                                    <th>Para quais culturas</th>
                                    <th>Frequência de Uso</th>
                                    <th>Certificado Orgânico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="fertilizantes-body">
                                <!-- Linhas dinâmicas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('fertilizantes')" class="btn-add">➕ Adicionar Fertilizante</button>
                    </div>
                </div>

                <div id="fitossanitarios" class="tab-content">
                    <h3>Produtos Fitossanitários</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Nome Comercial</th>
                                    <th>Ingrediente Ativo</th>
                                    <th>Fabricante</th>
                                    <th>Registro no Órgão Competente</th>
                                    <th>Para quais pragas/doenças</th>
                                    <th>Culturas aplicadas</th>
                                    <th>Frequência</th>
                                    <th>Certificado Orgânico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="fitossanitarios-body">
                                <!-- Linhas dinâmicas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('fitossanitarios')" class="btn-add">➕ Adicionar Fitossanitário</button>
                    </div>
                </div>

                <div id="sementes" class="tab-content">
                    <h3>Sementes e Mudas</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Variedade/Espécie</th>
                                    <th>Fornecedor/Marca</th>
                                    <th>Tipo</th>
                                    <th>Tratamento</th>
                                    <th>Certificado Orgânico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="sementes-body">
                                <!-- Linhas dinâmicas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('sementes')" class="btn-add">➕ Adicionar Semente/Muda</button>
                    </div>
                </div>

                <div id="substratos" class="tab-content">
                    <h3>Substratos e Condicionadores</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Nome Comercial</th>
                                    <th>Composição</th>
                                    <th>Fabricante</th>
                                    <th>Finalidade</th>
                                    <th>Quantidade Usada</th>
                                    <th>Certificado Orgânico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="substratos-body">
                                <!-- Linhas dinâmicas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('substratos')" class="btn-add">➕ Adicionar Substrato</button>
                    </div>
                </div>
            </section>

            <!-- Seção 8: Comercialização -->
            <section id="comercializacao" class="form-section">
                <div class="section-header">
                    <h2>8. Comercialização</h2>
                    <div class="section-progress" data-section="comercializacao"></div>
                </div>

                <div class="comercializacao-status">
                    <div class="form-group">
                        <label>Status atual de comercialização:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="status_comercializacao" value="ja_comercializo" onchange="toggleComercializacao(this)"> Já comercializo produtos orgânicos</label>
                            <label><input type="radio" name="status_comercializacao" value="ainda_nao" onchange="toggleComercializacao(this)"> Ainda não comercializo</label>
                        </div>
                    </div>
                </div>

                <div id="previsao-comercializacao" class="form-group" style="display:none;">
                    <label for="previsao_inicio_vendas">Previsão para começar a vender:</label>
                    <input type="month" id="previsao_inicio_vendas" name="previsao_inicio_vendas">
                    
                    <label for="plano_comercializacao">Descreva seus planos de comercialização:</label>
                    <textarea id="plano_comercializacao" name="plano_comercializacao" rows="3" 
                              placeholder="Ex: Pretendo vender em feira livre aos sábados..."></textarea>
                </div>

                <div id="canais-comercializacao" style="display:none;">
                    <h3>Canais de Comercialização</h3>
                    
                    <div class="comercializacao-group">
                        <h4>Venda Direta</h4>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="venda_feira" onchange="showFeiraDados(this)"> Feiras</label>
                            <label><input type="checkbox" name="venda_domicilio"> Entregas em Domicílio/Cestas</label>
                            <label><input type="checkbox" name="venda_csa"> CSA - Comunidade que Sustenta Agricultura</label>
                            <label><input type="checkbox" name="venda_horeca"> Hotéis, Restaurantes e Similares</label>
                            <label><input type="checkbox" name="venda_outro_direto"> Outro tipo de venda direta</label>
                        </div>
                        
                        <div id="feira-dados" class="feira-dados" style="display:none;">
                            <h5>Dados das Feiras</h5>
                            <div id="feiras-list" class="dynamic-list">
                                <!-- Feiras serão adicionadas dinamicamente -->
                            </div>
                            <button type="button" onclick="addFeira()" class="btn-secondary">+ Adicionar outra feira</button>
                        </div>
                    </div>
                    
                    <div class="comercializacao-group">
                        <h4>Revenda</h4>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="revenda_produtores_spg"> Outros produtores do SPG</label>
                            <label><input type="checkbox" name="revenda_pequeno_varejo"> Pequeno varejo</label>
                            <label><input type="checkbox" name="revenda_lojas_naturais"> Lojas de produtos naturais</label>
                            <label><input type="checkbox" name="revenda_supermercado_bairro"> Supermercado de bairro</label>
                            <label><input type="checkbox" name="revenda_rede_supermercado"> Rede de supermercado</label>
                            <label><input type="checkbox" name="revenda_atacadista"> Mercado atacadista</label>
                            <label><input type="checkbox" name="revenda_exportacao"> Mercado externo</label>
                            <label><input type="checkbox" name="revenda_distribuidores"> Distribuidores</label>
                        </div>
                    </div>
                    
                    <div class="comercializacao-group">
                        <h4>Venda Governamental</h4>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="venda_paa_pnae"> PAA/PNAE - Programa de Alimentação Escolar</label>
                        </div>
                    </div>
                </div>

                <!-- Transporte -->
                <div class="form-group">
                    <h3>Transporte dos Produtos</h3>
                    <label for="descricao_transporte">Descreva como é feito o transporte:</label>
                    <textarea id="descricao_transporte" name="descricao_transporte" rows="3"
                              placeholder="Ex: Veículo próprio refrigerado, caixas plásticas higienizadas..."></textarea>
                </div>
                
                <!-- Rastreabilidade -->
                <div class="form-group">
                    <h3>Sistema de Rastreabilidade</h3>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="rastreabilidade_lote"> Controle por lote</label>
                        <label><input type="checkbox" name="rastreabilidade_data"> Controle por data de colheita</label>
                        <label><input type="checkbox" name="rastreabilidade_talhao"> Identificação do talhão</label>
                        <label><input type="checkbox" name="rastreabilidade_nf"> Notas fiscais de produtor</label>
                    </div>
                    
                    <label for="descricao_rastreabilidade">Descreva como garante a rastreabilidade dos produtos:</label>
                    <textarea id="descricao_rastreabilidade" name="descricao_rastreabilidade" rows="3"
                              placeholder="Ex: Caderno de campo, etiquetas com data e talhão..."></textarea>
                </div>
            </section>

            <!-- Seção de Validação e Envio -->
            <section class="form-actions">
                <div class="validation-results" id="validation-results">
                    <!-- Resultados da validação aparecerão aqui -->
                </div>
                
                <div class="actions-grid">
                    <a href="anexo-producao-vegetal.html" class="btn-secondary">🌱 Anexo Produção Vegetal</a>
                    <button type="button" onclick="saveForm()" class="btn-secondary">💾 Salvar Rascunho</button>
                    <button type="button" onclick="validateForm()" class="btn-secondary">🔍 Validar Formulário</button>
                    <button type="button" onclick="exportJSON()" class="btn-secondary">📄 Exportar JSON</button>
                    <button type="button" onclick="generatePDF()" class="btn-secondary">📑 Gerar PDF</button>
                    <button type="submit" id="submit-btn" class="btn-primary" disabled>📤 Enviar PMO</button>
                </div>
                
                <div class="save-status" id="save-status">
                    <!-- Status de salvamento automático -->
                </div>
            </section>
        </form>
    </div>

    <!-- Templates -->
    <template id="fornecedor-row-template">
        <tr class="fornecedor-row">
            <td>
                <input type="text" name="fornecedor_nome[]" required placeholder="Nome completo">
            </td>
            <td>
                <input type="text" name="fornecedor_cpf[]" required class="cpf-mask" placeholder="000.000.000-00">
            </td>
            <td>
                <input type="date" name="fornecedor_nascimento[]" required>
            </td>
            <td>
                <select name="fornecedor_funcao[]" required>
                    <option value="">Selecione...</option>
                    <option value="produtor_responsavel">Produtor Responsável</option>
                    <option value="responsavel_tecnico">Responsável Técnico</option>
                    <option value="sócio">Sócio</option>
                    <option value="funcionario">Funcionário</option>
                    <option value="outro">Outro</option>
                </select>
            </td>
            <td>
                <div class="multiple-contacts">
                    <input type="tel" name="fornecedor_telefone[]" class="phone-mask" placeholder="(00) 00000-0000">
                    <button type="button" onclick="addContact(this, 'telefone')" class="btn-add-contact">+</button>
                </div>
            </td>
            <td>
                <div class="multiple-contacts">
                    <input type="email" name="fornecedor_email[]" placeholder="email@exemplo.com">
                    <button type="button" onclick="addContact(this, 'email')" class="btn-add-contact">+</button>
                </div>
            </td>
            <td>
                <button type="button" onclick="removeFornecedor(this)" class="btn-remove">❌</button>
            </td>
        </tr>
    </template>

    <template id="product-row-template">
        <tr class="product-row">
            <td class="row-number"></td>
            <td>
                <input type="text" name="produto_nome[]" required placeholder="Ex: Alface Crespa" list="produtos-sugestoes">
            </td>
            <td>
                <input type="text" name="produto_talhao[]" required placeholder="Ex: Talhão 2 e 4">
            </td>
            <td>
                <div class="compound-field">
                    <input type="number" name="produto_qtd[]" required min="0" step="0.01">
                    <select name="produto_unidade[]">
                        <option>unidade</option>
                        <option>maço</option>
                        <option>kg</option>
                        <option>bandeja</option>
                        <option>dúzia</option>
                        <option>caixa</option>
                        <option>saca</option>
                    </select>
                </div>
            </td>
            <td>
                <select name="produto_periodo[]">
                    <option>semanal</option>
                    <option>quinzenal</option>
                    <option>mensal</option>
                    <option>bimestral</option>
                    <option>semestral</option>
                    <option>anual</option>
                </select>
            </td>
            <td>
                <input type="number" name="produto_peso[]" step="0.001" min="0">
            </td>
            <td>
                <select name="produto_origem_muda[]" onchange="checkCustom(this)">
                    <option>N/A</option>
                    <option>Própria</option>
                    <option>Viveirista local</option>
                    <option>Doada</option>
                    <option value="custom">Outro...</option>
                </select>
                <input type="text" name="produto_origem_muda_custom[]" style="display:none" placeholder="Especifique">
            </td>
            <td>
                <input type="text" name="produto_origem_semente[]" placeholder="Ex: Isla, Feltrin, Própria">
            </td>
            <td>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="produto_tipo_conv_trat[]"> Conv. c/ Trat.</label>
                    <label><input type="checkbox" name="produto_tipo_conv_sem[]"> Conv. s/ Trat.</label>
                    <label><input type="checkbox" name="produto_tipo_org[]"> Orgânica</label>
                </div>
            </td>
            <td>
                <div class="action-buttons">
                    <button type="button" onclick="duplicateRow(this)" title="Duplicar" class="btn-icon">📋</button>
                    <button type="button" onclick="removeProductRow(this)" title="Remover" class="btn-icon">❌</button>
                </div>
            </td>
        </tr>
    </template>

    <script src="js/app.js"></script>
    <script src="js/form-validation.js"></script>
    <script src="js/dynamic-fields.js"></script>
    <script src="js/file-upload.js"></script>
    <script src="js/drawing.js"></script>
    <script src="js/export.js"></script>
</body>
</html>