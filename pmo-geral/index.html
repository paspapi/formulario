<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMO 2026 - Plano de Manejo Org√¢nico | ANC</title>
    <meta name="description" content="Formul√°rio digital para Plano de Manejo Org√¢nico da ANC - Associa√ß√£o de Agricultura Natural de Campinas">
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <h1>PMO 2026</h1>
                    <p>Plano de Manejo Org√¢nico</p>
                </div>
                <div class="header-info">
                    <p><strong>ANC - Associa√ß√£o de Agricultura Natural de Campinas</strong></p>
                    <p>Sistema Participativo de Garantia da Qualidade Org√¢nica</p>
                </div>
            </div>
            
            <!-- Barra de Progresso -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div id="progress-text" class="progress-text">0% Completo</div>
            </div>
        </header>

        <nav class="form-nav">
            <ul class="nav-sections">
                <li><a href="#dados-empresa" class="nav-link" data-section="dados-empresa">Dados da Empresa</a></li>
                <li><a href="#fornecedores" class="nav-link" data-section="fornecedores">Fornecedores</a></li>
                <li><a href="#endereco" class="nav-link" data-section="endereco">Endere√ßo</a></li>
                <li><a href="#historico" class="nav-link" data-section="historico">Hist√≥rico</a></li>
                <li><a href="#croqui" class="nav-link" data-section="croqui">Croqui</a></li>
                <li><a href="#produtos" class="nav-link" data-section="produtos">Produtos</a></li>
                <li><a href="#insumos" class="nav-link" data-section="insumos">Insumos</a></li>
                <li><a href="#comercializacao" class="nav-link" data-section="comercializacao">Comercializa√ß√£o</a></li>
            </ul>
        </nav>

        <form id="pmo-form" class="form-main" novalidate>
            <!-- Se√ß√£o 1: Dados da Empresa/Unidade de Produ√ß√£o -->
            <section id="dados-empresa" class="form-section">
                <div class="section-header">
                    <h2>1. Dados da Empresa/Unidade de Produ√ß√£o</h2>
                    <div class="section-progress" data-section="dados-empresa"></div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="razao_social">Raz√£o Social <span class="required">*</span></label>
                        <input type="text" id="razao_social" name="razao_social" required 
                               placeholder="Ex: Jo√£o Silva ME, Silva & Associados Ltda">
                    </div>

                    <div class="form-group">
                        <label for="nome_unidade">Nome da Unidade de Produ√ß√£o <span class="required">*</span></label>
                        <input type="text" id="nome_unidade" name="nome_unidade" required 
                               placeholder="Ex: S√≠tio Boa Vista, Ch√°cara S√£o Jos√©">
                    </div>

                    <div class="form-group">
                        <label for="nome_fantasia">Nome Fantasia</label>
                        <input type="text" id="nome_fantasia" name="nome_fantasia" 
                               placeholder="Ex: Org√¢nicos da Serra">
                    </div>

                    <div class="form-group">
                        <label>Tipo de Documento <span class="required">*</span></label>
                        <div class="radio-group">
                            <label><input type="radio" name="tipo_documento" value="cpf" onclick="toggleDocumento('cpf')"> CPF</label>
                            <label><input type="radio" name="tipo_documento" value="cnpj" onclick="toggleDocumento('cnpj')"> CNPJ</label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label id="documento-label">CPF/CNPJ <span class="required">*</span></label>
                        <input type="text" id="documento" name="documento" required>
                    </div>

                    <div class="form-group">
                        <label for="inscricao_estadual">Inscri√ß√£o Estadual</label>
                        <input type="text" id="inscricao_estadual" name="inscricao_estadual">
                    </div>

                    <div class="form-group">
                        <label for="inscricao_municipal">Inscri√ß√£o Municipal</label>
                        <input type="text" id="inscricao_municipal" name="inscricao_municipal">
                    </div>

                    <div class="form-group">
                        <label for="area_total">√Årea Total da Propriedade (hectares) <span class="required">*</span></label>
                        <input type="number" id="area_total" name="area_total" step="0.01" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="area_organica">√Årea para Produ√ß√£o Org√¢nica (hectares) <span class="required">*</span></label>
                        <input type="number" id="area_organica" name="area_organica" step="0.01" min="0" required>
                    </div>
                </div>

                <!-- Situa√ß√£o Fundi√°ria -->
                <div class="form-group">
                    <label>Situa√ß√£o da Propriedade <span class="required">*</span></label>
                    <div class="radio-group">
                        <label><input type="radio" name="situacao_propriedade" value="propria" onchange="toggleContrato(false)"> Pr√≥pria</label>
                        <label><input type="radio" name="situacao_propriedade" value="arrendada" onchange="toggleContrato(true)"> Arrendada</label>
                        <label><input type="radio" name="situacao_propriedade" value="parceria" onchange="toggleContrato(true)"> Parceria</label>
                        <label><input type="radio" name="situacao_propriedade" value="comodato" onchange="toggleContrato(true)"> Comodato</label>
                    </div>
                </div>

                <div id="contrato-info" class="form-group" style="display: none;">
                    <label for="contrato_validade">Validade do Contrato <span class="required">*</span></label>
                    <input type="date" id="contrato_validade" name="contrato_validade">
                    
                    <label for="contrato_arquivo">Upload do Contrato</label>
                    <div class="file-upload">
                        <input type="file" id="contrato_arquivo" name="contrato_arquivo" accept=".pdf">
                        <label for="contrato_arquivo" class="file-label">
                            <span>üìé Selecionar Contrato</span>
                        </label>
                    </div>
                </div>

            </section>

            <!-- Se√ß√£o 2: Dados dos Fornecedores -->
            <section id="fornecedores" class="form-section">
                <div class="section-header">
                    <h2>2. Dados dos Fornecedores/Respons√°veis</h2>
                    <div class="section-progress" data-section="fornecedores"></div>
                </div>

                <div class="dynamic-table-wrapper">
                    <table id="tabela-fornecedores" class="dynamic-table">
                        <thead>
                            <tr>
                                <th>Nome Completo <span class="required">*</span></th>
                                <th>CPF <span class="required">*</span></th>
                                <th>Data de Nascimento <span class="required">*</span></th>
                                <th>Fun√ß√£o/Cargo <span class="required">*</span></th>
                                <th>Telefones</th>
                                <th>Email</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="fornecedores-body">
                            <!-- Primeira linha padr√£o -->
                            <tr class="fornecedor-row">
                                <td>
                                    <input type="text" name="fornecedor_nome[]" required 
                                           placeholder="Nome completo">
                                </td>
                                <td>
                                    <input type="text" name="fornecedor_cpf[]" required 
                                           class="cpf-mask" placeholder="000.000.000-00">
                                </td>
                                <td>
                                    <input type="date" name="fornecedor_nascimento[]" required>
                                </td>
                                <td>
                                    <select name="fornecedor_funcao[]" required>
                                        <option value="">Selecione...</option>
                                        <option value="produtor_responsavel">Produtor Respons√°vel</option>
                                        <option value="responsavel_tecnico">Respons√°vel T√©cnico</option>
                                        <option value="s√≥cio">S√≥cio</option>
                                        <option value="funcionario">Funcion√°rio</option>
                                        <option value="outro">Outro</option>
                                    </select>
                                </td>
                                <td>
                                    <div class="multiple-contacts">
                                        <input type="tel" name="fornecedor_telefone[]" 
                                               class="phone-mask" placeholder="(00) 00000-0000">
                                        <button type="button" onclick="addContact(this, 'telefone')" class="btn-add-contact">+</button>
                                    </div>
                                </td>
                                <td>
                                    <div class="multiple-contacts">
                                        <input type="email" name="fornecedor_email[]" 
                                               placeholder="email@exemplo.com">
                                        <button type="button" onclick="addContact(this, 'email')" class="btn-add-contact">+</button>
                                    </div>
                                </td>
                                <td>
                                    <button type="button" onclick="removeFornecedor(this)" class="btn-remove" disabled>‚ùå</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" onclick="addFornecedor()" class="btn-add">‚ûï Adicionar Fornecedor</button>
                </div>
            </section>

            <!-- Se√ß√£o 3: Endere√ßo -->
            <section id="endereco" class="form-section">
                <div class="section-header">
                    <h2>3. Endere√ßo da Propriedade</h2>
                    <div class="section-progress" data-section="endereco"></div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="cep">CEP <span class="required">*</span></label>
                        <input type="text" id="cep" name="cep" required 
                               class="cep-mask" placeholder="00000-000"
                               onblur="buscarCEP()">
                    </div>

                    <div class="form-group span-2">
                        <label for="endereco">Endere√ßo/Localiza√ß√£o <span class="required">*</span></label>
                        <input type="text" id="endereco" name="endereco" required 
                               placeholder="Rua, Avenida, Estrada...">
                    </div>

                    <div class="form-group">
                        <label for="numero">N√∫mero</label>
                        <input type="text" id="numero" name="numero" placeholder="S/N">
                    </div>

                    <div class="form-group">
                        <label for="complemento">Complemento</label>
                        <input type="text" id="complemento" name="complemento" 
                               placeholder="Casa, Apto, S√≠tio...">
                    </div>

                    <div class="form-group">
                        <label for="bairro">Bairro/Zona Rural <span class="required">*</span></label>
                        <input type="text" id="bairro" name="bairro" required>
                    </div>

                    <div class="form-group">
                        <label for="cidade">Cidade <span class="required">*</span></label>
                        <input type="text" id="cidade" name="cidade" required>
                    </div>

                    <div class="form-group">
                        <label for="estado">Estado <span class="required">*</span></label>
                        <select id="estado" name="estado" required>
                            <option value="">Selecione...</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP" selected>SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>
                </div>

                <!-- Localiza√ß√£o da Propriedade -->
                <div class="location-section">
                    <h3>üìç Localiza√ß√£o Exata da Propriedade</h3>
                    
                    <div class="location-helper">
                        <div class="address-maps-link">
                            <button type="button" onclick="openMapsWithAddress()" class="btn-secondary">
                                üó∫Ô∏è Abrir Google Maps com Este Endere√ßo
                            </button>
                            <small class="help-text">
                                Clique para abrir o Google Maps j√° com o endere√ßo preenchido acima. 
                                Voc√™ poder√° refinar a localiza√ß√£o exata da sua propriedade.
                            </small>
                        </div>
                        
                        <div class="coordinates-instructions">
                            <div class="info-box">
                                <p><strong>üìã Como obter as coordenadas:</strong></p>
                                <ol>
                                    <li>Clique no bot√£o acima para abrir o Google Maps</li>
                                    <li>Encontre o local exato da sua propriedade</li>
                                    <li>Clique com bot√£o direito no ponto exato</li>
                                    <li>Selecione <strong>"Copiar coordenadas"</strong> no menu</li>
                                    <li>Cole as coordenadas no campo abaixo</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    
                    <div class="coordinates-input">
                        <div class="form-group full-width">
                            <label for="coordenadas_google">Coordenadas do Google Maps <span class="required">*</span></label>
                            <input type="text" id="coordenadas_google" name="coordenadas_google" required
                                   placeholder="Cole aqui as coordenadas copiadas do Google Maps (ex: -22.906847, -47.062860)"
                                   onchange="parseCoordinates(this.value)">
                            <small class="help-text">
                                Clique com bot√£o direito no Google Maps e selecione "Copiar coordenadas", 
                                depois cole aqui. As coordenadas ser√£o separadas automaticamente.
                            </small>
                        </div>
                        
                        <div class="coordinates-display">
                            <div class="form-group">
                                <label for="latitude">Latitude</label>
                                <input type="text" id="latitude" name="latitude" readonly
                                       placeholder="Ser√° preenchido automaticamente">
                            </div>
                            <div class="form-group">
                                <label for="longitude">Longitude</label>
                                <input type="text" id="longitude" name="longitude" readonly
                                       placeholder="Ser√° preenchido automaticamente">
                            </div>
                        </div>
                        
                        <div id="coordinates-preview" class="coordinates-preview" style="display: none;">
                            <div class="success-message">
                                <h4>‚úÖ Localiza√ß√£o Confirmada</h4>
                                <div id="coordinates-details"></div>
                                <button type="button" onclick="verifyLocation()" class="btn-secondary">
                                    üîç Verificar Localiza√ß√£o no Google Maps
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o 4: Hist√≥rico da √Årea -->
            <section id="historico" class="form-section">
                <div class="section-header">
                    <h2>4. Hist√≥rico da √Årea</h2>
                    <div class="section-progress" data-section="historico"></div>
                </div>

                <div class="historico-wrapper">
                    <h3>Culturas dos √öltimos 10 Anos</h3>
                    <p class="instruction">Complete as informa√ß√µes para cada ano, indicando as culturas plantadas e o tipo de manejo utilizado.</p>
                    
                    <div class="table-responsive">
                        <table id="historico-culturas" class="historico-table">
                            <thead>
                                <tr>
                                    <th>Ano</th>
                                    <th>Cultura/Animal</th>
                                    <th>√Årea (ha)</th>
                                    <th>Manejo Org√¢nico?</th>
                                    <th>Certificado?</th>
                                    <th>√öltimo Insumo N√£o Permitido</th>
                                    <th>Data Aplica√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody id="historico-body">
                                <!-- Anos ser√£o gerados via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Informa√ß√µes Complementares do Hist√≥rico -->
                    <div class="historico-complementar">
                        <h3>Informa√ß√µes Complementares do Hist√≥rico</h3>
                        
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label for="historico_atividade_anterior">Atividade Principal Antes da Agricultura Org√¢nica</label>
                                <textarea id="historico_atividade_anterior" name="historico_atividade_anterior" rows="3"
                                          placeholder="Ex: Agricultura convencional com milho e soja, pecu√°ria extensiva, √°rea de pasto..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="historico_inicio_organico">Ano de In√≠cio do Manejo Org√¢nico</label>
                                <input type="number" id="historico_inicio_organico" name="historico_inicio_organico" 
                                       min="1990" max="2026" placeholder="2020">
                            </div>
                            
                            <div class="form-group">
                                <label for="historico_certificacao_anterior">Certifica√ß√£o Org√¢nica Anterior?</label>
                                <select id="historico_certificacao_anterior" name="historico_certificacao_anterior" onchange="toggleCertificacaoAnterior(this)">
                                    <option value="">Selecione...</option>
                                    <option value="nao">Nunca foi certificado</option>
                                    <option value="sim_anc">Sim, pela ANC</option>
                                    <option value="sim_outra">Sim, por outra certificadora</option>
                                </select>
                            </div>
                            
                            <div id="certificacao-anterior-detalhes" class="form-group full-width" style="display: none;">
                                <label for="historico_certificadora_anterior">Nome da Certificadora Anterior</label>
                                <input type="text" id="historico_certificadora_anterior" name="historico_certificadora_anterior" 
                                       placeholder="Ex: IBD, ECOCERT, Certificadora XYZ">
                                
                                <label for="historico_periodo_certificacao" style="margin-top: 1rem;">Per√≠odo da Certifica√ß√£o Anterior</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 0.5rem;">
                                    <input type="month" id="historico_periodo_inicio" name="historico_periodo_inicio" placeholder="In√≠cio">
                                    <input type="month" id="historico_periodo_fim" name="historico_periodo_fim" placeholder="Fim">
                                </div>
                                
                                <label for="historico_motivo_mudanca" style="margin-top: 1rem;">Motivo da Mudan√ßa de Certificadora (se aplic√°vel)</label>
                                <textarea id="historico_motivo_mudanca" name="historico_motivo_mudanca" rows="2"
                                          placeholder="Ex: Custo, proximidade, filosofia de trabalho..."></textarea>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="historico_praticas_conservacao">Pr√°ticas de Conserva√ß√£o Implementadas</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" name="pratica_rotacao_culturas" value="rotacao"> Rota√ß√£o de culturas</label>
                                    <label><input type="checkbox" name="pratica_adubacao_verde" value="adubacao_verde"> Aduba√ß√£o verde</label>
                                    <label><input type="checkbox" name="pratica_compostagem" value="compostagem"> Compostagem</label>
                                    <label><input type="checkbox" name="pratica_cobertura_solo" value="cobertura"> Cobertura do solo</label>
                                    <label><input type="checkbox" name="pratica_controle_biologico" value="biologico"> Controle biol√≥gico</label>
                                    <label><input type="checkbox" name="pratica_barreiras_vegetais" value="barreiras"> Barreiras vegetais</label>
                                    <label><input type="checkbox" name="pratica_conservacao_agua" value="agua"> Conserva√ß√£o de √°gua</label>
                                    <label><input type="checkbox" name="pratica_diversificacao" value="diversificacao"> Diversifica√ß√£o de culturas</label>
                                </div>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="historico_desafios">Principais Desafios Enfrentados na Transi√ß√£o Org√¢nica</label>
                                <textarea id="historico_desafios" name="historico_desafios" rows="3"
                                          placeholder="Ex: Controle de pragas, fertilidade do solo, comercializa√ß√£o, custos..."></textarea>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="historico_melhorias">Melhorias Observadas com o Manejo Org√¢nico</label>
                                <textarea id="historico_melhorias" name="historico_melhorias" rows="3"
                                          placeholder="Ex: Melhoria da qualidade do solo, aumento da biodiversidade, redu√ß√£o de custos com insumos..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o 5: Croqui da Propriedade -->
            <section id="croqui" class="form-section">
                <div class="section-header">
                    <h2>5. Croqui da Propriedade</h2>
                    <div class="section-progress" data-section="croqui"></div>
                </div>

                <div class="croqui-info">
                    <div class="info-box">
                        <p><strong>‚ÑπÔ∏è Instru√ß√µes:</strong> O croqui pode ser desenhado √† m√£o, criado no computador, ou usar imagem do Google Maps/Earth</p>
                    </div>
                    
                    <div class="alert-box">
                        <p><strong>‚ö†Ô∏è OBRIGAT√ìRIO incluir no croqui:</strong></p>
                        <div class="requirements-grid">
                            <label><input type="checkbox" id="req-entrada"> Entrada da propriedade</label>
                            <label><input type="checkbox" id="req-casa"> Casa/Resid√™ncia (se houver)</label>
                            <label><input type="checkbox" id="req-armazens"> Armaz√©ns e galp√µes</label>
                            <label><input type="checkbox" id="req-insumos"> Local de guarda de insumos</label>
                            <label><input type="checkbox" id="req-rios"> Rios e cursos d'√°gua</label>
                            <label><input type="checkbox" id="req-plantio"> √Åreas de plantio (talh√µes, pomares, canteiros)</label>
                            <label><input type="checkbox" id="req-barreiras"> Barreiras vegetais</label>
                            <label><input type="checkbox" id="req-perenes"> Culturas perenes</label>
                            <label><input type="checkbox" id="req-processamento"> Locais de processamento</label>
                            <label><input type="checkbox" id="req-composteira"> Composteira</label>
                            <label><input type="checkbox" id="req-estradas"> Estradas</label>
                            <label><input type="checkbox" id="req-mata"> √Åreas de mata</label>
                            <label><input type="checkbox" id="req-animais"> Instala√ß√µes animais (se houver)</label>
                            <label><input type="checkbox" id="req-vizinhos"> Vizinhos confrontantes e suas atividades</label>
                        </div>
                    </div>
                </div>

                <div class="croqui-upload-area">
                    <div class="upload-options">
                        <button type="button" class="upload-btn" onclick="selectUploadType('file')">
                            üìé Upload de Arquivo
                        </button>
                        <button type="button" class="upload-btn" onclick="selectUploadType('draw')">
                            ‚úèÔ∏è Desenhar Online
                        </button>
                    </div>

                    <!-- Upload de Arquivo -->
                    <div id="file-upload-area" class="upload-type">
                        <div class="file-drop-zone" ondrop="dropHandler(event)" ondragover="dragOverHandler(event)">
                            <input type="file" id="croqui-file" name="croqui_file" accept="image/*,.pdf" onchange="previewCroqui(this)">
                            <label for="croqui-file" class="file-drop-label">
                                <div class="drop-icon">üìÅ</div>
                                <p>Clique ou arraste o arquivo aqui</p>
                                <small>Formatos aceitos: JPG, PNG, PDF (m√°x. 10MB)</small>
                            </label>
                        </div>
                        <div id="croqui-preview" class="file-preview"></div>
                    </div>

                    <!-- Canvas para Desenho -->
                    <div id="draw-area" class="upload-type" style="display:none;">
                        <div class="drawing-container">
                            <canvas id="drawing-canvas" width="800" height="600"></canvas>
                            <div class="drawing-tools">
                                <button type="button" class="tool-btn active" data-tool="pen" onclick="setTool('pen')">‚úèÔ∏è Caneta</button>
                                <button type="button" class="tool-btn" data-tool="eraser" onclick="setTool('eraser')">üßπ Borracha</button>
                                <button type="button" class="tool-btn" data-tool="text" onclick="setTool('text')">üìù Texto</button>
                                <div class="color-picker">
                                    <input type="color" id="pen-color" value="#000000" onchange="setPenColor(this.value)">
                                    <label for="pen-color">Cor</label>
                                </div>
                                <button type="button" onclick="clearCanvas()" class="btn-secondary">üóëÔ∏è Limpar</button>
                                <button type="button" onclick="saveDrawing()" class="btn-primary">üíæ Salvar Desenho</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o 6: Lista de Produtos -->
            <section id="produtos" class="form-section">
                <div class="section-header">
                    <h2>6. Lista de Produtos para Certifica√ß√£o</h2>
                    <div class="section-progress" data-section="produtos"></div>
                </div>

                <div class="section-warning">
                    <p><strong>‚ö†Ô∏è ATEN√á√ÉO:</strong> Esta lista constar√° no certificado. Apenas produtos aqui listados poder√£o ser comercializados em 2026</p>
                </div>

                <div class="products-table-wrapper">
                    <div class="table-actions top">
                        <button type="button" onclick="addProductRow()" class="btn-primary">‚ûï Adicionar Produto</button>
                        <button type="button" onclick="importProductList()" class="btn-secondary">üì• Importar Lista</button>
                        <button type="button" onclick="sortProducts()" class="btn-secondary">üî§ Ordenar Alfabeticamente</button>
                    </div>
                    
                    <div class="table-responsive">
                        <table id="tabela-produtos" class="products-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Produto/Variedade <span class="required">*</span></th>
                                    <th>Talh√£o/√Årea <span class="required">*</span></th>
                                    <th>Estimativa Produ√ß√£o <span class="required">*</span></th>
                                    <th>Per√≠odo</th>
                                    <th>Peso (kg/und)</th>
                                    <th>Origem Muda</th>
                                    <th>Origem Semente</th>
                                    <th>Tipo</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="produtos-body">
                                <!-- Primeira linha padr√£o -->
                                <tr class="product-row">
                                    <td class="row-number">1</td>
                                    <td>
                                        <input type="text" name="produto_nome[]" required 
                                               placeholder="Ex: Alface Crespa" 
                                               list="produtos-sugestoes">
                                    </td>
                                    <td>
                                        <input type="text" name="produto_talhao[]" required 
                                               placeholder="Ex: Talh√£o 2 e 4">
                                    </td>
                                    <td>
                                        <div class="compound-field">
                                            <input type="number" name="produto_qtd[]" required min="0" step="0.01" placeholder="100">
                                            <select name="produto_unidade[]">
                                                <option>unidade</option>
                                                <option>ma√ßo</option>
                                                <option>kg</option>
                                                <option>bandeja</option>
                                                <option>d√∫zia</option>
                                                <option>caixa</option>
                                                <option>saca</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <select name="produto_periodo[]">
                                            <option>semanal</option>
                                            <option>quinzenal</option>
                                            <option>mensal</option>
                                            <option>bimestral</option>
                                            <option>semestral</option>
                                            <option>anual</option>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="number" name="produto_peso[]" step="0.001" min="0" placeholder="0.200">
                                    </td>
                                    <td>
                                        <select name="produto_origem_muda[]" onchange="checkCustom(this)">
                                            <option>N/A</option>
                                            <option>Pr√≥pria</option>
                                            <option>Viveirista local</option>
                                            <option>Doada</option>
                                            <option value="custom">Outro...</option>
                                        </select>
                                        <input type="text" name="produto_origem_muda_custom[]" 
                                               style="display:none" 
                                               placeholder="Especifique">
                                    </td>
                                    <td>
                                        <input type="text" name="produto_origem_semente[]" 
                                               placeholder="Ex: Isla, Feltrin, Pr√≥pria">
                                    </td>
                                    <td>
                                        <div class="checkbox-group">
                                            <label><input type="checkbox" name="produto_tipo_conv_trat[]"> Conv. c/ Trat.</label>
                                            <label><input type="checkbox" name="produto_tipo_conv_sem[]"> Conv. s/ Trat.</label>
                                            <label><input type="checkbox" name="produto_tipo_org[]"> Org√¢nica</label>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="action-buttons">
                                            <button type="button" onclick="duplicateRow(this)" title="Duplicar" class="btn-icon">üìã</button>
                                            <button type="button" onclick="removeProductRow(this)" title="Remover" class="btn-icon">‚ùå</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- DataList para sugest√µes de produtos -->
                <datalist id="produtos-sugestoes">
                    <!-- Ser√° populado via JavaScript -->
                </datalist>
            </section>

            <!-- Se√ß√£o 7: Insumos -->
            <section id="insumos" class="form-section">
                <div class="section-header">
                    <h2>7. Insumos e Produtos Comerciais</h2>
                    <div class="section-progress" data-section="insumos"></div>
                </div>

                <div class="insumos-tabs">
                    <button type="button" class="tab-btn active" onclick="showTab('fertilizantes')">Fertilizantes</button>
                    <button type="button" class="tab-btn" onclick="showTab('fitossanitarios')">Fitossanit√°rios</button>
                    <button type="button" class="tab-btn" onclick="showTab('sementes')">Sementes/Mudas</button>
                    <button type="button" class="tab-btn" onclick="showTab('substratos')">Substratos</button>
                </div>

                <div id="fertilizantes" class="tab-content active">
                    <h3>Fertilizantes e Adubos</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Nome Comercial</th>
                                    <th>Ingrediente Ativo</th>
                                    <th>Fabricante</th>
                                    <th>Fornecedor</th>
                                    <th>Para quais culturas</th>
                                    <th>Frequ√™ncia de Uso</th>
                                    <th>Certificado Org√¢nico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="fertilizantes-body">
                                <!-- Linhas din√¢micas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('fertilizantes')" class="btn-add">‚ûï Adicionar Fertilizante</button>
                    </div>
                </div>

                <div id="fitossanitarios" class="tab-content">
                    <h3>Produtos Fitossanit√°rios</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Nome Comercial</th>
                                    <th>Ingrediente Ativo</th>
                                    <th>Fabricante</th>
                                    <th>Registro no √ìrg√£o Competente</th>
                                    <th>Para quais pragas/doen√ßas</th>
                                    <th>Culturas aplicadas</th>
                                    <th>Frequ√™ncia</th>
                                    <th>Certificado Org√¢nico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="fitossanitarios-body">
                                <!-- Linhas din√¢micas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('fitossanitarios')" class="btn-add">‚ûï Adicionar Fitossanit√°rio</button>
                    </div>
                </div>

                <div id="sementes" class="tab-content">
                    <h3>Sementes e Mudas</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Variedade/Esp√©cie</th>
                                    <th>Fornecedor/Marca</th>
                                    <th>Tipo</th>
                                    <th>Tratamento</th>
                                    <th>Certificado Org√¢nico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="sementes-body">
                                <!-- Linhas din√¢micas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('sementes')" class="btn-add">‚ûï Adicionar Semente/Muda</button>
                    </div>
                </div>

                <div id="substratos" class="tab-content">
                    <h3>Substratos e Condicionadores</h3>
                    <div class="table-responsive">
                        <table class="insumos-table">
                            <thead>
                                <tr>
                                    <th>Nome Comercial</th>
                                    <th>Composi√ß√£o</th>
                                    <th>Fabricante</th>
                                    <th>Finalidade</th>
                                    <th>Quantidade Usada</th>
                                    <th>Certificado Org√¢nico</th>
                                    <th>Upload NF/Certificado</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="substratos-body">
                                <!-- Linhas din√¢micas -->
                            </tbody>
                        </table>
                        <button type="button" onclick="addInsumoRow('substratos')" class="btn-add">‚ûï Adicionar Substrato</button>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o 8: Comercializa√ß√£o -->
            <section id="comercializacao" class="form-section">
                <div class="section-header">
                    <h2>8. Comercializa√ß√£o</h2>
                    <div class="section-progress" data-section="comercializacao"></div>
                </div>

                <div class="comercializacao-status">
                    <div class="form-group">
                        <label>Status atual de comercializa√ß√£o:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="status_comercializacao" value="ja_comercializo" onchange="toggleComercializacao(this)"> J√° comercializo produtos org√¢nicos</label>
                            <label><input type="radio" name="status_comercializacao" value="ainda_nao" onchange="toggleComercializacao(this)"> Ainda n√£o comercializo</label>
                        </div>
                    </div>
                </div>

                <div id="previsao-comercializacao" class="form-group" style="display:none;">
                    <label for="previsao_inicio_vendas">Previs√£o para come√ßar a vender:</label>
                    <input type="month" id="previsao_inicio_vendas" name="previsao_inicio_vendas">
                    
                    <label for="plano_comercializacao">Descreva seus planos de comercializa√ß√£o:</label>
                    <textarea id="plano_comercializacao" name="plano_comercializacao" rows="3" 
                              placeholder="Ex: Pretendo vender em feira livre aos s√°bados..."></textarea>
                </div>

                <div id="canais-comercializacao" style="display:none;">
                    <h3>Canais de Comercializa√ß√£o</h3>
                    
                    <div class="comercializacao-group">
                        <h4>Venda Direta</h4>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="venda_feira" onchange="showFeiraDados(this)"> Feiras</label>
                            <label><input type="checkbox" name="venda_domicilio"> Entregas em Domic√≠lio/Cestas</label>
                            <label><input type="checkbox" name="venda_csa"> CSA - Comunidade que Sustenta Agricultura</label>
                            <label><input type="checkbox" name="venda_horeca"> Hot√©is, Restaurantes e Similares</label>
                            <label><input type="checkbox" name="venda_outro_direto"> Outro tipo de venda direta</label>
                        </div>
                        
                        <div id="feira-dados" class="feira-dados" style="display:none;">
                            <h5>Dados das Feiras</h5>
                            <div id="feiras-list" class="dynamic-list">
                                <!-- Feiras ser√£o adicionadas dinamicamente -->
                            </div>
                            <button type="button" onclick="addFeira()" class="btn-secondary">+ Adicionar outra feira</button>
                        </div>
                    </div>
                    
                    <div class="comercializacao-group">
                        <h4>Revenda</h4>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="revenda_produtores_spg"> Outros produtores do SPG</label>
                            <label><input type="checkbox" name="revenda_pequeno_varejo"> Pequeno varejo</label>
                            <label><input type="checkbox" name="revenda_lojas_naturais"> Lojas de produtos naturais</label>
                            <label><input type="checkbox" name="revenda_supermercado_bairro"> Supermercado de bairro</label>
                            <label><input type="checkbox" name="revenda_rede_supermercado"> Rede de supermercado</label>
                            <label><input type="checkbox" name="revenda_atacadista"> Mercado atacadista</label>
                            <label><input type="checkbox" name="revenda_exportacao"> Mercado externo</label>
                            <label><input type="checkbox" name="revenda_distribuidores"> Distribuidores</label>
                        </div>
                    </div>
                    
                    <div class="comercializacao-group">
                        <h4>Venda Governamental</h4>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="venda_paa_pnae"> PAA/PNAE - Programa de Alimenta√ß√£o Escolar</label>
                        </div>
                    </div>
                </div>

                <!-- Transporte -->
                <div class="form-group">
                    <h3>Transporte dos Produtos</h3>
                    <label for="descricao_transporte">Descreva como √© feito o transporte:</label>
                    <textarea id="descricao_transporte" name="descricao_transporte" rows="3"
                              placeholder="Ex: Ve√≠culo pr√≥prio refrigerado, caixas pl√°sticas higienizadas..."></textarea>
                </div>
                
                <!-- Rastreabilidade -->
                <div class="form-group">
                    <h3>Sistema de Rastreabilidade</h3>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="rastreabilidade_lote"> Controle por lote</label>
                        <label><input type="checkbox" name="rastreabilidade_data"> Controle por data de colheita</label>
                        <label><input type="checkbox" name="rastreabilidade_talhao"> Identifica√ß√£o do talh√£o</label>
                        <label><input type="checkbox" name="rastreabilidade_nf"> Notas fiscais de produtor</label>
                    </div>
                    
                    <label for="descricao_rastreabilidade">Descreva como garante a rastreabilidade dos produtos:</label>
                    <textarea id="descricao_rastreabilidade" name="descricao_rastreabilidade" rows="3"
                              placeholder="Ex: Caderno de campo, etiquetas com data e talh√£o..."></textarea>
                </div>
            </section>

            <!-- Se√ß√£o de Valida√ß√£o e Envio -->
            <section class="form-actions">
                <div class="validation-results" id="validation-results">
                    <!-- Resultados da valida√ß√£o aparecer√£o aqui -->
                </div>
                
                <div class="actions-grid">
                    <a href="anexo-producao-vegetal.html" class="btn-secondary">üå± Anexo Produ√ß√£o Vegetal</a>
                    <button type="button" onclick="saveForm()" class="btn-secondary">üíæ Salvar Rascunho</button>
                    <button type="button" onclick="validateForm()" class="btn-secondary">üîç Validar Formul√°rio</button>
                    <button type="button" onclick="exportJSON()" class="btn-secondary">üìÑ Exportar JSON</button>
                    <button type="button" onclick="generatePDF()" class="btn-secondary">üìë Gerar PDF</button>
                    <button type="submit" id="submit-btn" class="btn-primary" disabled>üì§ Enviar PMO</button>
                </div>
                
                <div class="save-status" id="save-status">
                    <!-- Status de salvamento autom√°tico -->
                </div>
            </section>
        </form>
    </div>

    <!-- Templates -->
    <template id="fornecedor-row-template">
        <tr class="fornecedor-row">
            <td>
                <input type="text" name="fornecedor_nome[]" required placeholder="Nome completo">
            </td>
            <td>
                <input type="text" name="fornecedor_cpf[]" required class="cpf-mask" placeholder="000.000.000-00">
            </td>
            <td>
                <input type="date" name="fornecedor_nascimento[]" required>
            </td>
            <td>
                <select name="fornecedor_funcao[]" required>
                    <option value="">Selecione...</option>
                    <option value="produtor_responsavel">Produtor Respons√°vel</option>
                    <option value="responsavel_tecnico">Respons√°vel T√©cnico</option>
                    <option value="s√≥cio">S√≥cio</option>
                    <option value="funcionario">Funcion√°rio</option>
                    <option value="outro">Outro</option>
                </select>
            </td>
            <td>
                <div class="multiple-contacts">
                    <input type="tel" name="fornecedor_telefone[]" class="phone-mask" placeholder="(00) 00000-0000">
                    <button type="button" onclick="addContact(this, 'telefone')" class="btn-add-contact">+</button>
                </div>
            </td>
            <td>
                <div class="multiple-contacts">
                    <input type="email" name="fornecedor_email[]" placeholder="email@exemplo.com">
                    <button type="button" onclick="addContact(this, 'email')" class="btn-add-contact">+</button>
                </div>
            </td>
            <td>
                <button type="button" onclick="removeFornecedor(this)" class="btn-remove">‚ùå</button>
            </td>
        </tr>
    </template>

    <template id="product-row-template">
        <tr class="product-row">
            <td class="row-number"></td>
            <td>
                <input type="text" name="produto_nome[]" required placeholder="Ex: Alface Crespa" list="produtos-sugestoes">
            </td>
            <td>
                <input type="text" name="produto_talhao[]" required placeholder="Ex: Talh√£o 2 e 4">
            </td>
            <td>
                <div class="compound-field">
                    <input type="number" name="produto_qtd[]" required min="0" step="0.01">
                    <select name="produto_unidade[]">
                        <option>unidade</option>
                        <option>ma√ßo</option>
                        <option>kg</option>
                        <option>bandeja</option>
                        <option>d√∫zia</option>
                        <option>caixa</option>
                        <option>saca</option>
                    </select>
                </div>
            </td>
            <td>
                <select name="produto_periodo[]">
                    <option>semanal</option>
                    <option>quinzenal</option>
                    <option>mensal</option>
                    <option>bimestral</option>
                    <option>semestral</option>
                    <option>anual</option>
                </select>
            </td>
            <td>
                <input type="number" name="produto_peso[]" step="0.001" min="0">
            </td>
            <td>
                <select name="produto_origem_muda[]" onchange="checkCustom(this)">
                    <option>N/A</option>
                    <option>Pr√≥pria</option>
                    <option>Viveirista local</option>
                    <option>Doada</option>
                    <option value="custom">Outro...</option>
                </select>
                <input type="text" name="produto_origem_muda_custom[]" style="display:none" placeholder="Especifique">
            </td>
            <td>
                <input type="text" name="produto_origem_semente[]" placeholder="Ex: Isla, Feltrin, Pr√≥pria">
            </td>
            <td>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="produto_tipo_conv_trat[]"> Conv. c/ Trat.</label>
                    <label><input type="checkbox" name="produto_tipo_conv_sem[]"> Conv. s/ Trat.</label>
                    <label><input type="checkbox" name="produto_tipo_org[]"> Org√¢nica</label>
                </div>
            </td>
            <td>
                <div class="action-buttons">
                    <button type="button" onclick="duplicateRow(this)" title="Duplicar" class="btn-icon">üìã</button>
                    <button type="button" onclick="removeProductRow(this)" title="Remover" class="btn-icon">‚ùå</button>
                </div>
            </td>
        </tr>
    </template>

    <script src="js/app.js"></script>
    <script src="js/form-validation.js"></script>
    <script src="js/dynamic-fields.js"></script>
    <script src="js/file-upload.js"></script>
    <script src="js/drawing.js"></script>
    <script src="js/export.js"></script>
</body>
</html>