<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Se√ß√µes Complementares - Anexo Produ√ß√£o Vegetal PMO</title>
    <link rel="stylesheet" href="../pmo-geral/css/style.css">
    <link rel="stylesheet" href="anexo-styles.css">
</head>
<body>
    <div class="container">
        <!-- SE√á√ÉO 3: BARREIRAS VERDES E RISCOS -->
        <section id="barreiras-riscos" class="form-section">
            <h2>3. Barreiras Verdes e Gest√£o de Riscos</h2>

            <div class="barreiras-section">
                <h3>Estado de Conserva√ß√£o das Barreiras Verdes</h3>
                <select name="barreiras_estado" required onchange="showBarrierDetails(this)">
                    <option value="">Selecione...</option>
                    <option value="excelente">Excelente - Bem formadas e densas</option>
                    <option value="bom">Bom - Necessita pequenos reparos</option>
                    <option value="regular">Regular - Necessita manuten√ß√£o</option>
                    <option value="ruim">Ruim - Necessita reforma urgente</option>
                    <option value="inexistente">N√£o possui barreiras verdes</option>
                </select>

                <div id="barrier-details" style="display:none;">
                    <div class="barrier-composition">
                        <h4>Composi√ß√£o das barreiras:</h4>
                        <div class="species-checklist">
                            <label><input type="checkbox" name="barreira_capim"> Capim elefante/Napier</label>
                            <label><input type="checkbox" name="barreira_cana"> Cana-de-a√ß√∫car</label>
                            <label><input type="checkbox" name="barreira_hibisco"> Hibisco</label>
                            <label><input type="checkbox" name="barreira_arvores"> √Årvores (Eucalipto, Grev√≠lea)</label>
                            <label><input type="checkbox" name="barreira_bambu"> Bambu</label>
                            <label><input type="checkbox" name="barreira_outros"> Outras esp√©cies</label>
                        </div>
                        <input type="text" name="barreira_altura" placeholder="Altura m√©dia (metros)">
                        <input type="text" name="barreira_extensao" placeholder="Extens√£o total (metros)">
                    </div>
                </div>
            </div>

            <div class="risk-assessment">
                <h3>Avalia√ß√£o de Riscos</h3>

                <!-- Risco de Deriva -->
                <div class="risk-block">
                    <h4>Risco de Contamina√ß√£o por Deriva de Agrot√≥xicos</h4>
                    <div class="risk-options">
                        <label>
                            <input type="radio" name="risco_deriva" value="sim" onchange="showDerivaDetails(true)" required>
                            <span class="risk-yes">‚ö†Ô∏è SIM - Existe risco</span>
                        </label>
                        <label>
                            <input type="radio" name="risco_deriva" value="nao" onchange="showDerivaDetails(false)">
                            <span class="risk-no">‚úÖ N√ÉO - Sem risco</span>
                        </label>
                    </div>

                    <div id="deriva-details" style="display:none;" class="risk-details">
                        <div class="neighbor-analysis">
                            <h5>An√°lise dos vizinhos:</h5>
                            <table id="vizinhos-table">
                                <thead>
                                    <tr>
                                        <th>Dire√ß√£o</th>
                                        <th>Vizinho/Atividade</th>
                                        <th>Tipo de Cultura</th>
                                        <th>Usa Agrot√≥xicos?</th>
                                        <th>Dist√¢ncia (m)</th>
                                        <th>Prote√ß√£o</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Norte</td>
                                        <td><input type="text" name="vizinho_norte_nome"></td>
                                        <td><input type="text" name="vizinho_norte_cultura"></td>
                                        <td>
                                            <select name="vizinho_norte_agrotoxicos">
                                                <option value="">...</option>
                                                <option value="sim">Sim</option>
                                                <option value="nao">N√£o</option>
                                                <option value="desconhecido">Desconhecido</option>
                                            </select>
                                        </td>
                                        <td><input type="number" name="vizinho_norte_distancia" min="0"></td>
                                        <td><input type="text" name="vizinho_norte_protecao" placeholder="Barreira, mata, etc"></td>
                                    </tr>
                                    <tr>
                                        <td>Sul</td>
                                        <td><input type="text" name="vizinho_sul_nome"></td>
                                        <td><input type="text" name="vizinho_sul_cultura"></td>
                                        <td>
                                            <select name="vizinho_sul_agrotoxicos">
                                                <option value="">...</option>
                                                <option value="sim">Sim</option>
                                                <option value="nao">N√£o</option>
                                                <option value="desconhecido">Desconhecido</option>
                                            </select>
                                        </td>
                                        <td><input type="number" name="vizinho_sul_distancia" min="0"></td>
                                        <td><input type="text" name="vizinho_sul_protecao"></td>
                                    </tr>
                                    <tr>
                                        <td>Leste</td>
                                        <td><input type="text" name="vizinho_leste_nome"></td>
                                        <td><input type="text" name="vizinho_leste_cultura"></td>
                                        <td>
                                            <select name="vizinho_leste_agrotoxicos">
                                                <option value="">...</option>
                                                <option value="sim">Sim</option>
                                                <option value="nao">N√£o</option>
                                                <option value="desconhecido">Desconhecido</option>
                                            </select>
                                        </td>
                                        <td><input type="number" name="vizinho_leste_distancia" min="0"></td>
                                        <td><input type="text" name="vizinho_leste_protecao"></td>
                                    </tr>
                                    <tr>
                                        <td>Oeste</td>
                                        <td><input type="text" name="vizinho_oeste_nome"></td>
                                        <td><input type="text" name="vizinho_oeste_cultura"></td>
                                        <td>
                                            <select name="vizinho_oeste_agrotoxicos">
                                                <option value="">...</option>
                                                <option value="sim">Sim</option>
                                                <option value="nao">N√£o</option>
                                                <option value="desconhecido">Desconhecido</option>
                                            </select>
                                        </td>
                                        <td><input type="number" name="vizinho_oeste_distancia" min="0"></td>
                                        <td><input type="text" name="vizinho_oeste_protecao"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="mitigation-measures">
                            <h5>Medidas de mitiga√ß√£o adotadas:</h5>
                            <label><input type="checkbox" name="mitigacao_barreira"> Barreiras vegetais refor√ßadas</label>
                            <label><input type="checkbox" name="mitigacao_distancia"> Faixa de seguran√ßa (buffer)</label>
                            <label><input type="checkbox" name="mitigacao_acordo"> Acordo com vizinhos</label>
                            <label><input type="checkbox" name="mitigacao_horario"> Monitoramento de aplica√ß√µes</label>
                            <label><input type="checkbox" name="mitigacao_analise"> An√°lises de res√≠duos regulares</label>
                            <textarea name="mitigacao_outras" placeholder="Outras medidas de prote√ß√£o"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO 4: CONTROLE DE FORMIGAS -->
        <section id="controle-formigas" class="form-section">
            <h2>4. Manejo de Formigas</h2>

            <div class="ant-assessment">
                <h3>Situa√ß√£o das Formigas na Propriedade</h3>

                <div class="ant-severity">
                    <label>N√≠vel de infesta√ß√£o:</label>
                    <select name="formiga_nivel" onchange="updateAntControl(this)" required>
                        <option value="">Selecione...</option>
                        <option value="ausente">Ausente - N√£o h√° formigas cortadeiras</option>
                        <option value="baixo">Baixo - Poucos formigueiros isolados</option>
                        <option value="medio">M√©dio - V√°rios formigueiros, dano control√°vel</option>
                        <option value="alto">Alto - Muitos formigueiros, danos significativos</option>
                        <option value="severo">Severo - Infesta√ß√£o generalizada</option>
                    </select>
                </div>

                <div id="ant-control-methods" style="display:none;">
                    <h4>M√©todos de Controle Utilizados:</h4>

                    <div class="control-method">
                        <label class="method-header">
                            <input type="checkbox" name="controle_cultural" onchange="toggleMethod(this)">
                            <span>üå± Controle Cultural</span>
                        </label>
                        <div class="method-details" style="display:none;">
                            <label><input type="checkbox" name="cultural_plantio_repelente"> Plantio de esp√©cies repelentes (gergelim, mamona)</label>
                            <label><input type="checkbox" name="cultural_manejo_vegetacao"> Manejo da vegeta√ß√£o ao redor dos formigueiros</label>
                            <label><input type="checkbox" name="cultural_rotacao"> Rota√ß√£o com culturas menos atrativas</label>
                        </div>
                    </div>

                    <div class="control-method">
                        <label class="method-header">
                            <input type="checkbox" name="controle_mecanico" onchange="toggleMethod(this)">
                            <span>‚öôÔ∏è Controle Mec√¢nico</span>
                        </label>
                        <div class="method-details" style="display:none;">
                            <label><input type="checkbox" name="mecanico_escavacao"> Escava√ß√£o e remo√ß√£o da rainha</label>
                            <label><input type="checkbox" name="mecanico_inundacao"> Inunda√ß√£o dos formigueiros</label>
                            <label><input type="checkbox" name="mecanico_fogo"> Uso de fogo nos olheiros</label>
                        </div>
                    </div>

                    <div class="control-method">
                        <label class="method-header">
                            <input type="checkbox" name="controle_biologico" onchange="toggleMethod(this)">
                            <span>ü¶† Controle Biol√≥gico</span>
                        </label>
                        <div class="method-details" style="display:none;">
                            <label><input type="checkbox" name="biologico_fungos"> Aplica√ß√£o de fungos (Beauveria, Metarhizium)</label>
                            <label><input type="checkbox" name="biologico_extratos"> Extratos vegetais (nim, citronela)</label>
                            <input type="text" name="biologico_produto" placeholder="Nome do produto biol√≥gico utilizado">
                        </div>
                    </div>
                </div>

                <div class="ant-results">
                    <h4>Efic√°cia do Controle:</h4>
                    <textarea name="formiga_resultados"
                              placeholder="Descreva os resultados obtidos com o manejo de formigas"
                              rows="3"></textarea>
                </div>
            </div>
        </section>

        <!-- SE√á√ÉO 5: SUBSTRATO PARA MUDAS -->
        <section id="substrato-mudas" class="form-section">
            <h2>5. Substrato para Produ√ß√£o de Mudas</h2>

            <div class="substrate-usage">
                <div class="substrate-options">
                    <label>
                        <input type="radio" name="substrato_uso" value="nao" onchange="toggleSubstrate(this)">
                        N√£o utilizo substrato
                    </label>
                    <label>
                        <input type="radio" name="substrato_uso" value="proprio" onchange="toggleSubstrate(this)">
                        Preparo meu pr√≥prio substrato
                    </label>
                    <label>
                        <input type="radio" name="substrato_uso" value="comprado" onchange="toggleSubstrate(this)">
                        Compro substrato pronto
                    </label>
                </div>

                <div id="substrate-details" style="display:none;">
                    <div class="substrate-declaration">
                        <label class="important-check">
                            <input type="checkbox" name="substrato_aprovado" required>
                            <span>‚òëÔ∏è DECLARO que adquiro substrato/insumo aprovado para agricultura org√¢nica e garanto rastreabilidade</span>
                        </label>
                    </div>

                    <div class="substrate-composition">
                        <h3>Composi√ß√£o do Substrato</h3>
                        <table id="substrate-table">
                            <thead>
                                <tr>
                                    <th>Ingrediente/Material</th>
                                    <th>Origem</th>
                                    <th>Propor√ß√£o (%)</th>
                                    <th>Observa√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="substrate-body">
                                <tr>
                                    <td>
                                        <select name="substrato_ingrediente[]" onchange="checkCustomIngredient(this)">
                                            <option value="">Selecione...</option>
                                            <optgroup label="Base">
                                                <option>Terra vegetal</option>
                                                <option>Terra de barranco</option>
                                                <option>Areia</option>
                                                <option>Vermiculita</option>
                                                <option>Perlita</option>
                                                <option>Fibra de coco</option>
                                                <option>Casca de arroz carbonizada</option>
                                            </optgroup>
                                            <optgroup label="Mat√©ria Org√¢nica">
                                                <option>Composto org√¢nico</option>
                                                <option>H√∫mus de minhoca</option>
                                                <option>Esterco curtido</option>
                                                <option>Bokashi</option>
                                                <option>Turfa</option>
                                            </optgroup>
                                            <option value="outro">Outro...</option>
                                        </select>
                                        <input type="text" name="substrato_outro[]" style="display:none;" placeholder="Especifique">
                                    </td>
                                    <td>
                                        <select name="substrato_origem[]">
                                            <option>Pr√≥prio</option>
                                            <option>Comprado - certificado</option>
                                            <option>Comprado - convencional</option>
                                            <option>Doado</option>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="number" name="substrato_proporcao[]" min="0" max="100" required>
                                    </td>
                                    <td>
                                        <input type="text" name="substrato_obs[]" placeholder="Ex: Peneirado, esterilizado">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" onclick="addSubstrateIngredient()">‚ûï Adicionar ingrediente</button>

                        <div class="substrate-validation">
                            <p class="info">‚ÑπÔ∏è Total deve somar 100%: <span id="substrate-total">0%</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Fun√ß√µes espec√≠ficas para as se√ß√µes complementares

        function showBarrierDetails(select) {
            const details = document.getElementById('barrier-details');
            if (select.value && select.value !== 'inexistente') {
                details.style.display = 'block';
            } else {
                details.style.display = 'none';
            }
        }

        function showDerivaDetails(show) {
            const details = document.getElementById('deriva-details');
            details.style.display = show ? 'block' : 'none';
        }

        function updateAntControl(select) {
            const methods = document.getElementById('ant-control-methods');
            if (select.value && select.value !== 'ausente') {
                methods.style.display = 'block';
            } else {
                methods.style.display = 'none';
            }
        }

        function toggleMethod(checkbox) {
            const details = checkbox.parentElement.nextElementSibling;
            if (checkbox.checked) {
                details.style.display = 'block';
            } else {
                details.style.display = 'none';
                // Limpar campos quando desmarcar
                const inputs = details.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    if (input.type === 'checkbox') {
                        input.checked = false;
                    } else {
                        input.value = '';
                    }
                });
            }
        }

        function toggleSubstrate(radio) {
            const details = document.getElementById('substrate-details');
            if (radio.value !== 'nao') {
                details.style.display = 'block';
            } else {
                details.style.display = 'none';
            }
        }

        function checkCustomIngredient(select) {
            const otherInput = select.nextElementSibling;
            if (select.value === 'outro') {
                otherInput.style.display = 'block';
                otherInput.required = true;
            } else {
                otherInput.style.display = 'none';
                otherInput.required = false;
                otherInput.value = '';
            }
        }

        function addSubstrateIngredient() {
            const tbody = document.getElementById('substrate-body');
            const template = tbody.querySelector('tr');
            const newRow = template.cloneNode(true);

            // Limpar valores do novo item
            newRow.querySelectorAll('input, select').forEach(field => {
                field.value = '';
                if (field.type === 'checkbox') {
                    field.checked = false;
                }
            });

            tbody.appendChild(newRow);
            updateSubstrateTotal();
        }

        function updateSubstrateTotal() {
            const proporcoes = document.querySelectorAll('[name="substrato_proporcao[]"]');
            let total = 0;

            proporcoes.forEach(input => {
                total += parseFloat(input.value) || 0;
            });

            const totalDisplay = document.getElementById('substrate-total');
            totalDisplay.textContent = `${total}%`;

            if (total === 100) {
                totalDisplay.style.color = 'green';
            } else if (total > 100) {
                totalDisplay.style.color = 'red';
            } else {
                totalDisplay.style.color = 'orange';
            }
        }

        // Event listeners para c√°lculo autom√°tico do substrato
        document.addEventListener('input', function(e) {
            if (e.target.name === 'substrato_proporcao[]') {
                updateSubstrateTotal();
            }
        });
    </script>
</body>
</html>